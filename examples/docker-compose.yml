version: "3.9"

services:
  proxy:
    build:
      context: ..
      dockerfile: Dockerfile
    command: ["/usr/local/bin/huginn-proxy", "/config/compose.toml"]
    volumes:
      - ./config/compose.toml:/config/compose.toml:ro
      - ./certs:/config/certs:ro
    ports:
      - "7000:7000"   # Proxy server (HTTPS/HTTP)
      - "9090:9090"   # Metrics server (Prometheus)
    depends_on:
      - backend-a
      - backend-b

  backend-a:
    build:
      context: ..
      dockerfile: examples/backend/Dockerfile

  backend-b:
    build:
      context: ..
      dockerfile: examples/backend/Dockerfile

